# A continuación se muestra un ejemplo de cómo configurar un XLSX en un proyecto ASP.NET.

En este caso, se hará uso del proyecto ya creado.

# Generalidades:
- Versión del framework: .NET 9.0 (Soporte técnico de términos estándar).
- Base de datos: SSQL (SSMS/SQL SERVER MANAGEMENT STUDIO) 2022.

## 1. Frameworks instalados:

```
MicrosoftEntityFrameworkCore (9.0.8)
```
```
MicrosoftEntityFrameworkCore.SqlServer (9.0.8)
```
```
MicrosoftEntityFrameworkCore.Tools (9.0.8)
```

Esencial para la práctica:

```
ClosedXML.Report
```

## 2. En la vista Index.cs del controlador Home, he agregado un formulario que corresponde al botón:

````
@{
    using (Html.BeginForm("ExportarXLSX", "Producto", FormMethod.Post))
    {
        <input type="hidden" name="id" value="1" />
        <button type="submit" class="btn btn-success"><i class="bi bi-filetype-xlsx" style="width: 1em;">&nbsp;Exportar XLSX</i></button>
    }
    Html.EndForm();
}
````

## 3. Agregamos un función para de HttpPost en el controlador, puede ser en el controlador de ProductoController (el cual se creó en archivo de Creación de PDF.md).

Código de la función:

````
//Acción para generar el XLSX de los productos
[HttpPost]
public FileResult ExportarXLSX()
{
    long id = Convert.ToInt32(Request.Form["id"]);
    using (XLWorkbook wb = new XLWorkbook())
    {
        var productos = _context.Productos.ToList();

        IXLWorksheet ws = wb.Worksheets.Add();

        ws.Range("A1").Value = DateTime.Now.ToShortDateString() + " " + DateTime.Now.ToShortTimeString();
        ws.Range("A1").Style.Font.Bold = true;
        ws.Range("A1").Style.Font.FontSize = 14;
        ws.Range("A1").Style.Alignment.Horizontal = XLAlignmentHorizontalValues.Center;
        ws.Range("A1:E1").Merge();
        ws.Range("A3").Value = "ID";
        ws.Range("A3").Style.Font.Bold = true;
        ws.Range("B3").Value = "NOMBRE";
        ws.Range("B3").Style.Font.Bold = true;
        ws.Range("C3").Value = "DESCRIPCIÓN";
        ws.Range("C3").Style.Font.Bold = true;
        ws.Range("D3").Value = "PRECIO";
        ws.Range("D3").Style.Font.Bold = true;
        ws.Range("E3").Value = "STOCK";
        ws.Range("E3").Style.Font.Bold = true;

        int row = 4;
        foreach (Producto item in productos)
        {
            ws.Cell(row, 1).Value = item.Id;
            ws.Cell(row, 2).Value = item.Nombre;
            ws.Cell(row, 3).Value = item.Descripcion;
            ws.Cell(row, 4).Value = item.Precio;
            ws.Cell(row, 4).Style.NumberFormat.Format = "#,##0.00";
            ws.Cell(row, 5).Value = item.Stock;
            ws.Cell(row, 5).Style.NumberFormat.Format = "#,##0";
            row++;
        }
        ws.Column(1).AdjustToContents();
        ws.Column(2).AdjustToContents();
        ws.Column(3).AdjustToContents();
        ws.Column(4).AdjustToContents();
        ws.Column(5).AdjustToContents();
        using (MemoryStream stream = new MemoryStream())
        {
            wb.SaveAs(stream);
            return File(stream.ToArray(), "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", "Productos.xlsx");
        }
    }
}
````

# Anexos:

_1. Vista del botón:_

<img width="1919" height="1079" alt="image" src="https://github.com/user-attachments/assets/ffb80c08-d801-4ba6-8999-92250589cb8d" />

_2. Vista del libro de excel (archivo XLSX):_

<img width="1920" height="1020" alt="image" src="https://github.com/user-attachments/assets/2930f364-8e4a-4774-9f94-c9a8be7e0444" />
